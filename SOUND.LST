Microsoft (R) Macro Assembler Version 5.10                  12/7/19 23:13:19
                                                             Page     1-1


				PUBLIC SOUND
				
				.Model LARGE
 0000				DATA1 SEGMENT PARA 'DATA'
				
				
 0000  6B 69 6E 67 73 76	Filename DB 'kingsv.wav', 0
       2E 77 61 76 00		
				
 000B  0000			Filehandle DW ?
				
 000D  C949[			sounddata DB 51529 dup(0)
	   00			
			 ]	
				
				
 C956				DATA1 ENDS
				
				.Code
 0000				SOUND PROC FAR
				    
				    ASSUME DS:DATA1
 0000  B8 ---- R		    MOV AX , DATA1
 0003  8E D8			    MOV DS , AX
					
 0005  E8 0029 R		    CALL OpenFile
 0008  E8 0037 R		    CALL ReadData
					
 000B  8D 1E 000D R		    LEA BX , sounddata ; BL contains index at t
				he current drawn pixel
					
					
				; Drawing loop
 000F				aLoop:
 000F  BA 022C			    mov dx, 22ch
 0012  B0 10				mov al, 10h
 0014  EE				out dx, al
					
					
 0015  8A 07				MOV AL,[BX]
 0017  EE				out dx, al
 0018  B9 24D9				mov cx, 9433
 001B					delay:
 001B  90				nop
 001C  E2 FD				loop delay 
 001E  43				inc BX
 001F  81 FB C949		    CMP BX , 51529
 0023  75 EA			JNE aloop
 0025  E8 0047 R		    call CloseFile
				    
 0028  CB			RETF    
 0029				SOUND ENDP
				   
				
Microsoft (R) Macro Assembler Version 5.10                  12/7/19 23:13:19
                                                             Page     1-2


				;------------------------------------------
				
 0029				OpenFile PROC NEAR
				
				    ; Open file
				
 0029  B4 3D			    MOV AH, 3Dh
 002B  B0 00			    MOV AL, 0 ; read only
 002D  8D 16 0000 R		    LEA DX, Filename
 0031  CD 21			    INT 21h
				    
				    ; you should check carry flag to make sure 
				it worked correctly
				    ; carry = 0 -> successful , file handle -> 
				AX
				    ; carry = 1 -> failed , AX -> error code
				     
 0033  A3 000B R		    MOV [Filehandle], AX
				    
 0036  C3			    RETN
				
 0037				OpenFile ENDP
				
				
				
				;----------------------------------------------
				-
				
				
 0037				ReadData PROC NEAR
				
 0037  B4 3F			    MOV AH,3Fh
 0039  8B 1E 000B R		    MOV BX, [Filehandle]
 003D  B9 C949			    MOV CX, 51529 ; number of bytes to read
 0040  8D 16 000D R		    LEA DX, sounddata
 0044  CD 21			    INT 21h
 0046  C3			    RETN
 0047				ReadData ENDP 
				
				;----------------------------------------------
				--
				
 0047				CloseFile PROC NEAR
 0047  B4 3E				MOV AH, 3Eh
 0049  8B 1E 000B R			MOV BX, [Filehandle]
				
 004D  CD 21				INT 21h
 004F  C3				RETN
 0050				CloseFile ENDP
				
				    
				    
				    
				    
Microsoft (R) Macro Assembler Version 5.10                  12/7/19 23:13:19
                                                             Page     1-3


				    end SOUND
Microsoft (R) Macro Assembler Version 5.10                  12/7/19 23:13:19
                                                             Symbols-1


Segments and Groups:

                N a m e         	Length	 Align	Combine Class

DATA1  . . . . . . . . . . . . .  	C956	PARA	NONE	'DATA'
DGROUP . . . . . . . . . . . . .  	GROUP
  _DATA  . . . . . . . . . . . .  	0000	WORD	PUBLIC	'DATA'
SOUND_TEXT . . . . . . . . . . .  	0050	WORD	PUBLIC	'CODE'

Symbols:            

                N a m e         	Type	 Value	 Attr

ALOOP  . . . . . . . . . . . . .  	L NEAR	000F	SOUND_TEXT

CLOSEFILE  . . . . . . . . . . .  	N PROC	0047	SOUND_TEXT	Length = 0009

DELAY  . . . . . . . . . . . . .  	L NEAR	001B	SOUND_TEXT

FILEHANDLE . . . . . . . . . . .  	L WORD	000B	DATA1
FILENAME . . . . . . . . . . . .  	L BYTE	0000	DATA1

OPENFILE . . . . . . . . . . . .  	N PROC	0029	SOUND_TEXT	Length = 000E

READDATA . . . . . . . . . . . .  	N PROC	0037	SOUND_TEXT	Length = 0010

SOUND  . . . . . . . . . . . . .  	F PROC	0000	SOUND_TEXT	Global	Length = 0029
SOUNDDATA  . . . . . . . . . . .  	L BYTE	000D	DATA1	Length = C949

@CODE  . . . . . . . . . . . . .  	TEXT  sound_TEXT		
@CODESIZE  . . . . . . . . . . .  	TEXT  1		
@CPU . . . . . . . . . . . . . .  	TEXT  0101h		
@DATASIZE  . . . . . . . . . . .  	TEXT  1		
@FILENAME  . . . . . . . . . . .  	TEXT  sound		
@VERSION . . . . . . . . . . . .  	TEXT  510		


    100 Source  Lines
    100 Total   Lines
     26 Symbols

  47924 + 459336 Bytes symbol space free

      0 Warning Errors
      0 Severe  Errors
